# Phase 6: 测试与发布

**类型**: release
**状态**: pending
**依赖**: Phase 5 (功能完成)

## 目标

确保动画系统在各设备上流畅运行，完成性能优化和真机测试，准备发布。

## User Stories

### US-023: 性能优化和测试
**范围**: 全项目

- [ ] 同时渲染 1 英雄 + 3 怪物 + 粒子特效，保持 60fps
- [ ] 资源预加载，避免战斗中卡顿
- [ ] 内存使用稳定，无泄漏
- [ ] iPad 真机测试通过
- [ ] iPhone 真机测试通过

---

## 性能指标

| 指标 | 目标值 | 测试方法 |
|------|--------|----------|
| 帧率 | >= 60fps | Xcode Instruments |
| 单帧渲染 | < 16ms | Performance Monitor |
| 内存增长 | < 50MB/小时 | Memory Graph |
| 启动时间 | < 3s | 手动计时 |
| 资源加载 | < 1s | 首次战斗前 |

## 测试清单

### 功能测试

- [ ] 从首页进入战斗流程正常
- [ ] 书写识别准确率不变
- [ ] 伤害计算正确
- [ ] 怪物生成和移动正常
- [ ] Boss 阶段触发正确
- [ ] 胜利/失败判定正确
- [ ] 返回首页后再次进入正常

### 动画测试

- [ ] 所有角色动画播放流畅
- [ ] 动画过渡无跳帧
- [ ] 事件回调时机准确
- [ ] 粒子效果正常显示
- [ ] 音效与动画同步

### 兼容性测试

| 设备 | 状态 | 备注 |
|------|------|------|
| iPad Pro 12.9" | | |
| iPad Air | | |
| iPad mini | | |
| iPhone 15 Pro | | |
| iPhone SE | | |

### 边界条件

- [ ] 快速连续书写
- [ ] 同时多只怪物死亡
- [ ] Boss + 小怪同时出现
- [ ] 低电量模式
- [ ] 后台切换返回

---

## 优化清单

### 已完成优化

| 优化项 | 效果 |
|--------|------|
| | |

### 待优化项

| 优化项 | 优先级 | 状态 |
|--------|--------|------|
| 资源预加载 | 高 | |
| 粒子数量限制 | 中 | |
| 纹理图集合并 | 中 | |
| 内存缓存清理 | 低 | |

---

## 发布准备

- [ ] battle-v2 保留作为备用
- [ ] 添加版本切换开关（可选）
- [ ] 更新 CHANGELOG
- [ ] 截图/录屏用于展示

---

## Phase 完成测试

**类型**: release

- [ ] 所有功能测试通过
- [ ] 所有动画测试通过
- [ ] iPad 真机 60fps 稳定
- [ ] iPhone 真机 60fps 稳定
- [ ] 内存无泄漏（运行 10 分钟）
- [ ] 无 crash 或 ANR
- [ ] 用户体验优于 battle-v2
- [ ] `npx tsc --noEmit` 通过
- [ ] `npm start` 无警告
